(function(t){function n(n){for(var r,c,i=n[0],s=n[1],l=n[2],d=0,f=[];d<i.length;d++)c=i[d],Object.prototype.hasOwnProperty.call(o,c)&&o[c]&&f.push(o[c][0]),o[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(n);while(f.length)f.shift()();return a.push.apply(a,l||[]),e()}function e(){for(var t,n=0;n<a.length;n++){for(var e=a[n],r=!0,i=1;i<e.length;i++){var s=e[i];0!==o[s]&&(r=!1)}r&&(a.splice(n--,1),t=c(c.s=e[0]))}return t}var r={},o={app:0},a=[];function c(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,c),e.l=!0,e.exports}c.m=t,c.c=r,c.d=function(t,n,e){c.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,n){if(1&n&&(t=c(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(c.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)c.d(e,r,function(n){return t[n]}.bind(null,r));return e},c.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(n,"a",n),n},c.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},c.p="/twc-worship-pptx/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=n,i=i.slice();for(var l=0;l<i.length;l++)n(i[l]);var u=s;a.push([1,"chunk-vendors"]),e()})({0:function(t,n){},"0425":function(t,n,e){t.exports=e.p+"img/ccma_logo_white.a178253e.png"},"070b":function(t,n,e){"use strict";e("aa01")},1:function(t,n,e){t.exports=e("56d7")},"1f2b":function(t,n,e){t.exports=e.p+"img/background.4f452f36.jpg"},2:function(t,n){},5207:function(t,n,e){t.exports=e.p+"img/twc_logo.d76ef225.png"},"56d7":function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var r=e("7a23");function o(t,n,e,o,a,c){var i=Object(r["k"])("main-page");return Object(r["g"])(),Object(r["c"])(i)}e("4989"),e("ab8b");var a=Object(r["p"])("data-v-5aef2acd");Object(r["i"])("data-v-5aef2acd");var c={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},i=Object(r["f"])("a",{class:"navbar-brand",href:"#"},[Object(r["f"])("h4",null,"詩歌PPT製作器"),Object(r["f"])("div",{class:"subtitle text-secondary"},"中華宣道會大圍堂")],-1),s={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},l=Object(r["e"])(" 完成 "),u={class:"container"},d={class:"card-header"},f={class:"card-body"},p={key:0,class:"card-footer"};Object(r["h"])();var b=a((function(t,n,e,o,a,b){var g=Object(r["k"])("add-song-form");return Object(r["g"])(),Object(r["c"])(r["a"],null,[Object(r["f"])("nav",c,[i,Object(r["f"])("button",{class:"btn btn-success float-right",disabled:a.downloading,onClick:n[1]||(n[1]=function(t){return b.download()})},[a.downloading?(Object(r["g"])(),Object(r["c"])("span",s)):Object(r["d"])("",!0),l],8,["disabled"])]),Object(r["f"])("div",u,[(Object(r["g"])(!0),Object(r["c"])(r["a"],null,Object(r["j"])(a.songCount,(function(t){return Object(r["g"])(),Object(r["c"])("div",{key:t,class:"card my-4"},[Object(r["f"])("div",d,[Object(r["f"])("strong",null,"第 "+Object(r["l"])(t)+" 首",1)]),Object(r["f"])("div",f,[Object(r["f"])(g,{ref:"addSongForm"+t},null,512)]),t==a.songCount?(Object(r["g"])(),Object(r["c"])("div",p,[Object(r["f"])("button",{class:"btn btn-secondary float-right",onClick:n[2]||(n[2]=function(t){return a.songCount=a.songCount+1})}," 新增歌曲 ")])):Object(r["d"])("",!0)])})),128))])],64)})),g=(e("4de4"),e("4160"),e("b0c0"),e("159b"),e("ac1f"),e("841c"),{class:"form-group"}),h=Object(r["f"])("label",{for:"songName"},"歌名",-1),m={class:"input-group"},y={class:"input-group-append"},v={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},j=Object(r["e"])(" 搜尋歌詞 "),O={class:"form-group"},w=Object(r["f"])("label",{for:"lyrics"},"歌詞",-1),F={class:"form-group"},x=Object(r["f"])("label",{for:"copyright"},"版權",-1);function S(t,n,e,o,a,c){return Object(r["g"])(),Object(r["c"])("form",null,[Object(r["f"])("div",g,[h,Object(r["f"])("div",m,[Object(r["n"])(Object(r["f"])("input",{type:"text",class:"form-control",id:"songName","onUpdate:modelValue":n[1]||(n[1]=function(t){return a.name=t}),placeholder:"(請貼上歌名)"},null,512),[[r["m"],a.name]]),Object(r["f"])("div",y,[Object(r["f"])("button",{class:"btn btn-outline-primary",disabled:a.isSearching||void 0===a.name||0==a.name.length,onClick:n[2]||(n[2]=Object(r["o"])((function(t){return c.search()}),["prevent"]))},[a.isSearching?(Object(r["g"])(),Object(r["c"])("span",v)):Object(r["d"])("",!0),j],8,["disabled"])])])]),Object(r["f"])("div",O,[w,Object(r["n"])(Object(r["f"])("textarea",{class:"form-control",id:"lyrics","onUpdate:modelValue":n[3]||(n[3]=function(t){return a.lyrics=t}),placeholder:"(請貼上歌詞)",rows:"10"},null,512),[[r["m"],a.lyrics]]),Object(r["f"])("button",{type:"button",class:"btn btn-outline-primary btn-sm float-right my-1",onClick:n[4]||(n[4]=function(t){return c.formatText()})},"整理歌詞")]),Object(r["f"])("div",F,[x,Object(r["n"])(Object(r["f"])("textarea",{class:"form-control copyright-input",id:"copyright","onUpdate:modelValue":n[5]||(n[5]=function(t){return a.copyright=t}),rows:"5",placeholder:"(請貼上版權內容)"},null,512),[[r["m"],a.copyright]])])])}e("99af"),e("a15b"),e("d81d"),e("13d5"),e("d3b7"),e("25f0"),e("466d"),e("1276"),e("498a");var k=e("260b"),T=(e("8934"),18);function z(t){if(t.length<=T)return[t];var n=t.match(/[  ,，.。;；]$/);n&&(t=t.substring(0,n.index));var e=[],r="",o="",a=t.substring(0,T).match(/.+[  ,，.。;；]/);return a?(r=a[0],o=t.substring(a[0].length)):(r=t.substring(0,T),o=t.substring(T)),n&&(o+=n[0]),e=e.concat(r),e=e.concat(o),e}var _={data:function(){return{name:"",copyright:"",lyrics:"",isSearching:!1}},computed:{formattedLyrics:function(){var t=this.lyrics.split("\n");return t=t.map((function(t){return t.trim()})).filter((function(t){return t.length>0})).reduce((function(t,n){return t.concat(z(n))}),[]),t.join("\n")}},methods:{formatText:function(){this.lyrics=this.formattedLyrics},search:function(){var t=this;this.isSearching=!0;var n=k["a"].functions().httpsCallable("searchLyrics");n(this.name).then((function(n){n.data&&n.data.lyrics&&(t.lyrics=n.data.lyrics,t.copyright=n.data.copyright,t.formatText()),t.isSearching=!1})).catch((function(n){alert(n.toString()),t.isSearching=!1}))}}};_.render=S;var C=_,I=e("5530"),P=e("8f74"),M=e("1f2b"),H=e.n(M),J=e("9004"),L=e.n(J),B=e("0425"),K=e.n(B),A=e("5207"),N=e.n(A);function U(t){var n=t.addSlide();n.background={path:H.a},n.addImage({path:L.a,x:"40%",y:"40%",w:"70%",h:"20%"}),n.addText("敬拜讚美",{x:"40%",y:"40%",w:"50%",h:"20%",align:"center",shrinkText:!0,bold:!0,color:"FFFF00",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function V(t){var n=t.addSlide();n.background={fill:"0000FF"},n.addImage({path:K.a,x:"3%",y:"5%",w:.8,h:.8}),n.addImage({path:N.a,x:"85%",y:"5%",w:186/104*.7,h:.7});var e=327/982*100,r=100-e,o={x:"0%",y:"".concat(r,"%"),w:"100%",h:"".concat(e,"%")};return n.addShape(t.ShapeType.rect,Object(I["a"])(Object(I["a"])({},o),{},{fill:{color:"00FFFF",transparency:53}})),n}function $(t,n,e){var r=V(t);r.addText("【".concat(n,"】"),{x:"5%",y:"67%",w:"45%",h:"28%",align:"left",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"}),e&&r.addText("".concat(e),{x:"50%",y:"67%",w:"45%",h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:24,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function D(t,n){var e=V(t);e.addText(n,{x:"0%",y:"67%",w:"100%",h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function Q(t,n,e,r){$(t,n,e);for(var o=r.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),a=0;a<o.length;a++){var c=o[a];if(a+1<o.length){var i=o[a+1];i.match(/^[\d副]/)||(c+="\n",c+=i,a++)}D(t,c)}}var Y=function(t){var n=new P["a"];return n.layout="LAYOUT_16x9",U(n),{addSong:function(t,e,r){return Q(n,t,e,r)},save:function(){return n.writeFile(t)},saveBlob:function(){return n.write("blob")}}},E=e("aeb1"),G=e.n(E),R={data:function(){return{songCount:1,downloading:!1}},components:{"add-song-form":C},computed:{songs:function(){for(var t=[],n=1;n<=this.songCount;n++){var e={name:this.$refs["addSongForm"+n].name,copyright:this.$refs["addSongForm"+n].copyright,lyrics:this.$refs["addSongForm"+n].formattedLyrics};t.push(e)}return t.filter((function(t){return t.name&&t.lyrics}))}},methods:{download:function(){var t=this;this.downloading=!0;var n=Y();if(0==this.songs.length)return alert("請加入最少一首詩歌。"),void(this.downloading=!1);this.songs.forEach((function(t){n.addSong(t.name,t.copyright,t.lyrics)})),n.saveBlob().then((function(t){var n="application/vnd.openxmlformats-officedocument.presentationml.presentation",e=new Blob([t],{type:n});return G()(e,"詩歌.pptx")})).then((function(){t.downloading=!1}))}}};e("070b");R.render=b,R.__scopeId="data-v-5aef2acd";var W=R,X={name:"App",components:{"main-page":W}};X.render=o;var q=X,Z=(e("000b"),{apiKey:"AIzaSyD82Fj6-PkcMTD3IQ7w1631t5XpBwpNJRY",authDomain:"twc-worship-pptx.firebaseapp.com",projectId:"twc-worship-pptx",storageBucket:"twc-worship-pptx.appspot.com",messagingSenderId:"406134015845",appId:"1:406134015845:web:c85594772c56dde54cc38c",measurementId:"G-87L3WCNQLV"});k["a"].initializeApp(Z),k["a"].analytics(),Object(r["b"])(q).mount("#app")},9004:function(t,n,e){t.exports=e.p+"img/cover_text_background.fa02efe2.png"},aa01:function(t,n,e){}});
//# sourceMappingURL=app.f42be3cc.js.map