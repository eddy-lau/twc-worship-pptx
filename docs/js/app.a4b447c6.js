(function(t){function n(n){for(var r,a,i=n[0],s=n[1],l=n[2],f=0,d=[];f<i.length;f++)a=i[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(n);while(d.length)d.shift()();return c.push.apply(c,l||[]),e()}function e(){for(var t,n=0;n<c.length;n++){for(var e=c[n],r=!0,i=1;i<e.length;i++){var s=e[i];0!==o[s]&&(r=!1)}r&&(c.splice(n--,1),t=a(a.s=e[0]))}return t}var r={},o={app:0},c=[];function a(n){if(r[n])return r[n].exports;var e=r[n]={i:n,l:!1,exports:{}};return t[n].call(e.exports,e,e.exports,a),e.l=!0,e.exports}a.m=t,a.c=r,a.d=function(t,n,e){a.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,n){if(1&n&&(t=a(t)),8&n)return t;if(4&n&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(a.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)a.d(e,r,function(n){return t[n]}.bind(null,r));return e},a.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(n,"a",n),n},a.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},a.p="/twc-worship-pptx/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=n,i=i.slice();for(var l=0;l<i.length;l++)n(i[l]);var u=s;c.push([1,"chunk-vendors"]),e()})({0:function(t,n){},"0425":function(t,n,e){t.exports=e.p+"img/ccma_logo_white.0392c5c6.png"},"070b":function(t,n,e){"use strict";e("6309")},1:function(t,n,e){t.exports=e("56d7")},2:function(t,n){},5207:function(t,n,e){t.exports=e.p+"img/twc_logo.6ddc805b.png"},"56d7":function(t,n,e){"use strict";e.r(n);e("e260"),e("e6cf"),e("cca6"),e("a79d");var r=e("7a23");function o(t,n,e,o,c,a){var i=Object(r["k"])("main-page");return Object(r["g"])(),Object(r["c"])(i)}e("4989"),e("ab8b");var c=Object(r["p"])("data-v-5aef2acd");Object(r["i"])("data-v-5aef2acd");var a={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},i=Object(r["f"])("a",{class:"navbar-brand",href:"#"},[Object(r["f"])("h4",null,"詩歌PPT製作器"),Object(r["f"])("div",{class:"subtitle text-secondary"},"中華宣道會大圍堂")],-1),s={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},l=Object(r["e"])(" 完成 "),u={class:"container"},f={class:"card-header"},d={class:"card-body"},p={key:0,class:"card-footer"};Object(r["h"])();var b=c((function(t,n,e,o,c,b){var g=Object(r["k"])("add-song-form");return Object(r["g"])(),Object(r["c"])(r["a"],null,[Object(r["f"])("nav",a,[i,Object(r["f"])("button",{class:"btn btn-success float-right",disabled:c.downloading,onClick:n[1]||(n[1]=function(t){return b.download()})},[c.downloading?(Object(r["g"])(),Object(r["c"])("span",s)):Object(r["d"])("",!0),l],8,["disabled"])]),Object(r["f"])("div",u,[(Object(r["g"])(!0),Object(r["c"])(r["a"],null,Object(r["j"])(c.songCount,(function(t){return Object(r["g"])(),Object(r["c"])("div",{key:t,class:"card my-4"},[Object(r["f"])("div",f,[Object(r["f"])("strong",null,"第 "+Object(r["l"])(t)+" 首",1)]),Object(r["f"])("div",d,[Object(r["f"])(g,{ref:"addSongForm"+t},null,512)]),t==c.songCount?(Object(r["g"])(),Object(r["c"])("div",p,[Object(r["f"])("button",{class:"btn btn-secondary float-right",onClick:n[2]||(n[2]=function(t){return c.songCount=c.songCount+1})}," 新增歌曲 ")])):Object(r["d"])("",!0)])})),128))])],64)})),g=(e("4de4"),e("4160"),e("b0c0"),e("159b"),e("ac1f"),e("841c"),{class:"form-group"}),h=Object(r["f"])("label",{for:"songName"},"歌名",-1),m={class:"input-group"},y={class:"input-group-append"},j={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},v=Object(r["e"])(" 搜尋歌詞 "),O={class:"form-group"},w=Object(r["f"])("label",{for:"lyrics"},"歌詞",-1),F={class:"form-group"},x=Object(r["f"])("label",{for:"copyright"},"版權",-1);function S(t,n,e,o,c,a){return Object(r["g"])(),Object(r["c"])("form",null,[Object(r["f"])("div",g,[h,Object(r["f"])("div",m,[Object(r["n"])(Object(r["f"])("input",{type:"text",class:"form-control",id:"songName","onUpdate:modelValue":n[1]||(n[1]=function(t){return c.name=t}),placeholder:"(請貼上歌名)"},null,512),[[r["m"],c.name]]),Object(r["f"])("div",y,[Object(r["f"])("button",{class:"btn btn-outline-primary",disabled:c.isSearching||void 0===c.name||0==c.name.length,onClick:n[2]||(n[2]=Object(r["o"])((function(t){return a.search()}),["prevent"]))},[c.isSearching?(Object(r["g"])(),Object(r["c"])("span",j)):Object(r["d"])("",!0),v],8,["disabled"])])])]),Object(r["f"])("div",O,[w,Object(r["n"])(Object(r["f"])("textarea",{class:"form-control",id:"lyrics","onUpdate:modelValue":n[3]||(n[3]=function(t){return c.lyrics=t}),placeholder:"(請貼上歌詞)",rows:"10"},null,512),[[r["m"],c.lyrics]]),Object(r["f"])("button",{type:"button",class:"btn btn-outline-primary btn-sm float-right my-1",onClick:n[4]||(n[4]=function(t){return a.formatText()})},"整理歌詞")]),Object(r["f"])("div",F,[x,Object(r["n"])(Object(r["f"])("textarea",{class:"form-control copyright-input",id:"copyright","onUpdate:modelValue":n[5]||(n[5]=function(t){return c.copyright=t}),rows:"5",placeholder:"(請貼上版權內容)"},null,512),[[r["m"],c.copyright]])])])}e("99af"),e("a15b"),e("d81d"),e("13d5"),e("d3b7"),e("25f0"),e("466d"),e("1276"),e("498a");var k=e("260b"),T=(e("8934"),20);function z(t){if(t.length<=T)return[t];var n=t.match(/[  ,，.。;；]$/);n&&(t=t.substring(0,n.index));var e=[],r="",o="",c=t.substring(0,T).match(/.+[  ,，.。;；]/);return c?(r=c[0],o=t.substring(c[0].length)):(r=t.substring(0,T),o=t.substring(T)),n&&(o+=n[0]),e=e.concat(r),e=e.concat(o),e}var C={data:function(){return{name:"",copyright:"",lyrics:"",isSearching:!1}},computed:{formattedLyrics:function(){var t=this.lyrics.split("\n");return t=t.map((function(t){return t.trim()})).filter((function(t){return t.length>0})).reduce((function(t,n){return t.concat(z(n))}),[]),t.join("\n")}},methods:{formatText:function(){this.lyrics=this.formattedLyrics},search:function(){var t=this;this.isSearching=!0;var n=k["a"].functions().httpsCallable("searchLyrics");n(this.name).then((function(n){n.data&&n.data.lyrics&&(t.lyrics=n.data.lyrics,t.copyright=n.data.copyright,t.formatText()),t.isSearching=!1})).catch((function(n){alert(n.toString()),t.isSearching=!1}))}}};C.render=S;var M=C,_=e("5530"),P=e("8f74"),H=e("0425"),I=e.n(H),J=e("5207"),L=e.n(J);function A(t){var n=K(t);n.addText("敬拜讚美",{x:"0%",y:"75%",w:"100%",h:"20%",align:"center",shrinkText:!0,bold:!0,color:"FFC000",fontFace:"Microsoft JhengHei",fontSize:68,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.43,angle:45,blur:3,offset:3},lang:"zh-HK"})}function B(t,n){var e=327/982*100,r=100-e,o={x:"0%",y:"".concat(r,"%"),w:"100%",h:"".concat(e,"%")};t.defineSlideMaster({title:n,background:{fill:"0000FF"},objects:[{image:{path:I.a,x:"3%",y:"5%",w:.98,h:.98}},{image:{path:L.a,x:"85%",y:"5%",w:186/104*.7,h:.7}},{rect:Object(_["a"])(Object(_["a"])({},o),{},{fill:{color:"6666FF",transparency:0}})}]})}function K(t){var n=t.addSlide({masterName:"MASTER"});return n}function N(t,n,e){var r=K(t);r.addText("【".concat(n,"】"),{x:"5%",y:"67%",w:"45%",h:"28%",align:"left",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"}),e&&r.addText("".concat(e),{x:"50%",y:"67%",w:"45%",h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:24,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function U(t,n){var e=K(t);e.addText(n,{x:"0%",y:"67%",w:"100%",h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function V(t,n,e,r){N(t,n,e);for(var o=r.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),c=0;c<o.length;c++){var a=o[c];if(c+1<o.length){var i=o[c+1];i.match(/^[\d副]/)||(a+="\n",a+=i,c++)}U(t,a)}}var $=function(t){var n=new P["a"];return n.layout="LAYOUT_16x9",B(n,"MASTER"),A(n),{addSong:function(t,e,r){return V(n,t,e,r)},save:function(){return n.writeFile(t)},saveBlob:function(){return n.write("blob")}}},D=e("aeb1"),E=e.n(D),R={data:function(){return{songCount:1,downloading:!1}},components:{"add-song-form":M},computed:{songs:function(){for(var t=[],n=1;n<=this.songCount;n++){var e={name:this.$refs["addSongForm"+n].name,copyright:this.$refs["addSongForm"+n].copyright,lyrics:this.$refs["addSongForm"+n].formattedLyrics};t.push(e)}return t.filter((function(t){return t.name&&t.lyrics}))}},methods:{download:function(){var t=this;this.downloading=!0;var n=$();if(0==this.songs.length)return alert("請加入最少一首詩歌。"),void(this.downloading=!1);this.songs.forEach((function(t){n.addSong(t.name,t.copyright,t.lyrics)})),n.saveBlob().then((function(t){var n="application/vnd.openxmlformats-officedocument.presentationml.presentation",e=new Blob([t],{type:n});return E()(e,"詩歌.pptx")})).then((function(){t.downloading=!1}))}}};e("070b");R.render=b,R.__scopeId="data-v-5aef2acd";var Q=R,Y={name:"App",components:{"main-page":Q}};Y.render=o;var G=Y,W=(e("000b"),{apiKey:"AIzaSyD82Fj6-PkcMTD3IQ7w1631t5XpBwpNJRY",authDomain:"twc-worship-pptx.firebaseapp.com",projectId:"twc-worship-pptx",storageBucket:"twc-worship-pptx.appspot.com",messagingSenderId:"406134015845",appId:"1:406134015845:web:c85594772c56dde54cc38c",measurementId:"G-87L3WCNQLV"});k["a"].initializeApp(W),k["a"].analytics(),Object(r["b"])(G).mount("#app")},6309:function(t,n,e){}});
//# sourceMappingURL=app.a4b447c6.js.map