(function(t){function e(e){for(var r,a,i=e[0],s=e[1],l=e[2],f=0,d=[];f<i.length;f++)a=i[f],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);u&&u(e);while(d.length)d.shift()();return c.push.apply(c,l||[]),n()}function n(){for(var t,e=0;e<c.length;e++){for(var n=c[e],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(c.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},o={app:0},c=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="/twc-worship-pptx/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=s;c.push([1,"chunk-vendors"]),n()})({0:function(t,e){},1:function(t,e,n){t.exports=n("56d7")},2:function(t,e){},3932:function(t,e,n){t.exports=n.p+"img/ccma_twc_logo.9c5ee251.png"},"478e":function(t,e,n){},5207:function(t,e,n){t.exports=n.p+"img/twc_logo.6ddc805b.png"},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function o(t,e,n,o,c,a){var i=Object(r["k"])("main-page");return Object(r["g"])(),Object(r["c"])(i)}n("4989"),n("ab8b");var c=Object(r["q"])("data-v-5a2e03ad");Object(r["i"])("data-v-5a2e03ad");var a={class:"navbar navbar-expand-lg navbar-light bg-light fixed-top"},i=Object(r["f"])("a",{class:"navbar-brand",href:"#"},[Object(r["f"])("h4",null,"詩歌PPT製作器"),Object(r["f"])("div",{class:"subtitle text-secondary"},"中華宣道會大圍堂")],-1),s={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},l=Object(r["e"])(" 完成 "),u={class:"container"},f={class:"form-check"},d=Object(r["f"])("label",{class:"form-check-label",for:"flexCheckDefault"}," 文字在上方 ",-1),p={class:"card-header"},b={class:"card-body"},h={key:0,class:"card-footer"};Object(r["h"])();var g=c((function(t,e,n,o,c,g){var m=Object(r["k"])("add-song-form");return Object(r["g"])(),Object(r["c"])(r["a"],null,[Object(r["f"])("nav",a,[i,Object(r["f"])("button",{class:"btn btn-success float-right",disabled:c.downloading,onClick:e[1]||(e[1]=function(t){return g.download()})},[c.downloading?(Object(r["g"])(),Object(r["c"])("span",s)):Object(r["d"])("",!0),l],8,["disabled"])]),Object(r["f"])("div",u,[Object(r["f"])("div",f,[Object(r["o"])(Object(r["f"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=function(t){return c.textOnTop=t}),id:"flexCheckDefault"},null,512),[[r["m"],c.textOnTop]]),d]),(Object(r["g"])(!0),Object(r["c"])(r["a"],null,Object(r["j"])(c.songCount,(function(t){return Object(r["g"])(),Object(r["c"])("div",{key:t,class:"card my-4"},[Object(r["f"])("div",p,[Object(r["f"])("strong",null,"第 "+Object(r["l"])(t)+" 首",1)]),Object(r["f"])("div",b,[Object(r["f"])(m,{ref:"addSongForm"+t,textOnTop:c.textOnTop},null,8,["textOnTop"])]),t==c.songCount?(Object(r["g"])(),Object(r["c"])("div",h,[Object(r["f"])("button",{class:"btn btn-secondary float-right",onClick:e[3]||(e[3]=function(t){return c.songCount=c.songCount+1})}," 新增歌曲 ")])):Object(r["d"])("",!0)])})),128))])],64)})),m=(n("4de4"),n("4160"),n("b0c0"),n("159b"),n("ac1f"),n("841c"),{class:"form-group"}),y=Object(r["f"])("label",{for:"songName"},"歌名",-1),O={class:"input-group"},j={class:"input-group-append"},v={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},w=Object(r["e"])(" 搜尋歌詞 "),x={class:"form-group"},F=Object(r["f"])("label",{for:"lyrics"},"歌詞",-1),S={class:"form-group"},T=Object(r["f"])("label",{for:"copyright"},"版權",-1);function k(t,e,n,o,c,a){return Object(r["g"])(),Object(r["c"])("form",null,[Object(r["f"])("div",m,[y,Object(r["f"])("div",O,[Object(r["o"])(Object(r["f"])("input",{type:"text",class:"form-control",id:"songName","onUpdate:modelValue":e[1]||(e[1]=function(t){return c.name=t}),placeholder:"(請貼上歌名)"},null,512),[[r["n"],c.name]]),Object(r["f"])("div",j,[Object(r["f"])("button",{class:"btn btn-outline-primary",disabled:c.isSearching||void 0===c.name||0==c.name.length,onClick:e[2]||(e[2]=Object(r["p"])((function(t){return a.search()}),["prevent"]))},[c.isSearching?(Object(r["g"])(),Object(r["c"])("span",v)):Object(r["d"])("",!0),w],8,["disabled"])])])]),Object(r["f"])("div",x,[F,Object(r["o"])(Object(r["f"])("textarea",{class:"form-control",id:"lyrics","onUpdate:modelValue":e[3]||(e[3]=function(t){return c.lyrics=t}),placeholder:"(請貼上歌詞)",rows:"10"},null,512),[[r["n"],c.lyrics]]),Object(r["f"])("button",{type:"button",class:"btn btn-outline-primary btn-sm float-right my-1",onClick:e[4]||(e[4]=function(t){return a.formatText()})},"整理歌詞")]),Object(r["f"])("div",S,[T,Object(r["o"])(Object(r["f"])("textarea",{class:"form-control copyright-input",id:"copyright","onUpdate:modelValue":e[5]||(e[5]=function(t){return c.copyright=t}),rows:"5",placeholder:"(請貼上版權內容)"},null,512),[[r["n"],c.copyright]])])])}n("99af"),n("a15b"),n("d81d"),n("13d5"),n("d3b7"),n("25f0"),n("466d"),n("1276"),n("498a");var C=n("260b"),z=(n("8934"),{props:{textOnTop:{type:Boolean}},data:function(){return{name:"",copyright:"",lyrics:"",isSearching:!1}},computed:{formattedLyrics:function(){var t=this,e=this.lyrics.split("\n");return e=e.map((function(t){return t.trim()})).filter((function(t){return t.length>0})).reduce((function(e,n){return e.concat(t.wrap(n))}),[]),e.join("\n")}},methods:{wrap:function(t){var e=this.textOnTop?14:20;if(t.length<=e)return[t];var n=t.match(/[  ,，.。;；]$/);n&&(t=t.substring(0,n.index));var r=[],o="",c="",a=t.substring(0,e).match(/.+[  ,，.。;；]/);return a?(o=a[0],c=t.substring(a[0].length)):(o=t.substring(0,e),c=t.substring(e)),n&&(c+=n[0]),r=r.concat(o),r=r.concat(c),r},formatText:function(){this.lyrics=this.formattedLyrics},search:function(){var t=this;this.isSearching=!0;var e=C["a"].functions().httpsCallable("searchLyrics");e(this.name).then((function(e){e.data&&e.data.lyrics&&(t.lyrics=e.data.lyrics,t.copyright=e.data.copyright,t.formatText()),t.isSearching=!1})).catch((function(e){alert(e.toString()),t.isSearching=!1}))}}});z.render=k;var M=z,_=n("5530"),P=n("8f74"),H=n("3932"),I=n.n(H),J=n("5207"),L=n.n(J);function A(t,e){var n=D(t),r=e?"5%":"75%";n.addText("敬拜讚美",{x:"0%",y:r,w:"100%",h:"20%",align:"center",shrinkText:!0,bold:!0,color:"FFC000",fontFace:"Microsoft JhengHei",fontSize:68,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.43,angle:45,blur:3,offset:3},lang:"zh-HK"})}function B(t,e,n){var r=327/982*100,o=n?0:100-r,c={x:"0%",y:"".concat(o,"%"),w:"100%",h:"".concat(r,"%")},a=n?100:0;t.defineSlideMaster({title:e,background:{fill:"0000FF"},objects:[{image:{path:I.a,x:"3%",y:"3%",w:.98,h:.98}},{image:{path:L.a,x:"85%",y:"5%",w:186/104*.7,h:.7}},{rect:Object(_["a"])(Object(_["a"])({},c),{},{fill:{color:"6666FF",transparency:a}})}]})}function D(t){var e=t.addSlide({masterName:"MASTER"});return e}function K(t,e,n,r){var o=D(t),c=r?"0%":"67%",a=r?"20%":"5%",i=r?"30%":"45%";o.addText("【".concat(e,"】"),{x:a,y:c,w:i,h:"28%",align:"left",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"});var s=r?"30%":"45%";n&&o.addText("".concat(n),{x:"50%",y:c,w:s,h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:24,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function N(t,e,n){var r=D(t),o=n?"0%":"67%",c=n?"70%":"100%",a=n?"15%":"0%";r.addText(e,{x:a,y:o,w:c,h:"28%",align:"center",shrinkText:!0,bold:!0,color:"FFFFFF",fontFace:"Microsoft JhengHei",fontSize:36,glow:{size:10,color:"000000",transparency:0},shadow:{type:"outer",color:"7F7F7F",opacity:.47,angle:45,blur:3,offset:3},lang:"zh-HK"})}function U(t,e,n,r,o){K(t,e,n,o);for(var c=r.split("\n").map((function(t){return t.trim()})).filter((function(t){return t.length>0})),a=0;a<c.length;a++){var i=c[a];if(a+1<c.length){var s=c[a+1];s.match(/^[\d副]/)||(i+="\n",i+=s,a++)}N(t,i,o)}}var V=function(t){var e=new P["a"];return e.layout="LAYOUT_16x9",B(e,"MASTER",t),A(e,t),{addSong:function(n,r,o){return U(e,n,r,o,t)},saveBlob:function(){return e.write("blob")}}},$=n("aeb1"),E=n.n($),R={data:function(){return{songCount:1,downloading:!1,textOnTop:!0}},components:{"add-song-form":M},computed:{songs:function(){for(var t=[],e=1;e<=this.songCount;e++){var n={name:this.$refs["addSongForm"+e].name,copyright:this.$refs["addSongForm"+e].copyright,lyrics:this.$refs["addSongForm"+e].formattedLyrics};t.push(n)}return console.log(t),t.filter((function(t){return t.name&&t.lyrics}))}},methods:{download:function(){var t=this;this.downloading=!0;var e=V(this.textOnTop);if(0==this.songs.length)return alert("請加入最少一首詩歌。"),void(this.downloading=!1);this.songs.forEach((function(t){e.addSong(t.name,t.copyright,t.lyrics)})),e.saveBlob().then((function(t){var e="application/vnd.openxmlformats-officedocument.presentationml.presentation",n=new Blob([t],{type:e});return E()(n,"詩歌.pptx")})).then((function(){t.downloading=!1}))}}};n("5cf8");R.render=g,R.__scopeId="data-v-5a2e03ad";var Q=R,Y={name:"App",components:{"main-page":Q}};Y.render=o;var q=Y,G=(n("000b"),{apiKey:"AIzaSyD82Fj6-PkcMTD3IQ7w1631t5XpBwpNJRY",authDomain:"twc-worship-pptx.firebaseapp.com",projectId:"twc-worship-pptx",storageBucket:"twc-worship-pptx.appspot.com",messagingSenderId:"406134015845",appId:"1:406134015845:web:c85594772c56dde54cc38c",measurementId:"G-87L3WCNQLV"});C["a"].initializeApp(G),C["a"].analytics(),Object(r["b"])(q).mount("#app")},"5cf8":function(t,e,n){"use strict";n("478e")}});
//# sourceMappingURL=app.0d38135c.js.map